<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Empower Farmer</title>
<script src="cordova.js"></script>
<script src="js/jquery-1.11.3.min.js"></script>
<script src="js/jquery.mobile-1.4.5.min.js"></script>
<script src="js/jquery-listify.js"></script>
<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
<!-- Google Maps -->
<!-- Map input box css -->
<style type="text/css">
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
    .controls {
        margin-top: 10px;
        border: 1px solid transparent;
        border-radius: 2px 0 0 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        height: 32px;
        outline: none;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }
    #pac-input {
        background-color: #fff;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        margin-left: 12px;
        padding: 0 11px 0 13px;
        text-overflow: ellipsis;
        width: 300px;
    }
    #pac-input:focus {
        border-color: #4d90fe;
    }
    #pac-input2 {
        background-color: #fff;
        font-family: Roboto;
        font-size: 15px;
        font-weight: 300;
        margin-left: 12px;
        padding: 0 11px 0 13px;
        text-overflow: ellipsis;
        width: 300px;
    }
    #pac-input2:focus {
        border-color: #4d90fe;
    }
    .pac-container {
        font-family: Roboto;
    }
    #type-selector {
        color: #fff;
        background-color: #4d90fe;
        padding: 5px 11px 0px 11px;
    }
    #type-selector label {
        font-family: Roboto;
        font-size: 13px;
        font-weight: 300;
    }
    #target {
        width: 345px;
    }
</style>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAeIkiU_0tjVFORuJf5rLm9Vho0JbmIIgs&libraries=places&callback=initAutocomplete"
    async defer></script>
<script>
    // This example adds a search box to a map, using the Google Place Autocomplete
    // feature. People can enter geographical searches. The search box will return a
    // pick list containing a mix of places and predicted search terms.
    function initAutocomplete() {

        var marker;
        var map = new google.maps.Map(document.getElementById('map'), {
            center: {
                lat: 13.0192151,
                lng: 77.55222650000002
            },
            zoom: 13,
            mapTypeControl:false,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        {
            //Initialize Latitude Longitude
            myCurrentLocation.latitude = 13.0192151;
            myCurrentLocation.longitude = 77.55222650000002;

            myAddress=new google.maps.LatLng(13.0192151,77.55222650000002);
            marker=new google.maps.Marker({
                position:myAddress,
                draggable:true,
                icon: new google.maps.MarkerImage('images/marker001.png',
                    new google.maps.Size(18, 50),
                    new google.maps.Point(0,0),
                    new google.maps.Point((18/2+0.4),50),
                    new google.maps.Size(18, 50)
                )
            });
            marker.setMap(map);

            var contentString = ''+
            '<button onclick="window.parent.myCurrentLocation.setMyLocationByInfoWindow(this)">Set My Location </button>';

            var infowindow = new google.maps.InfoWindow({
                content: contentString
            });
            marker.addListener('click', function() {
                infowindow.open(map, marker);
            });

            google.maps.event.addListener(marker, 'dragend', function() 
            {
                myCurrentLocation.latitude = marker.position.lat();
                myCurrentLocation.longitude = marker.position.lng();
            });
        }

        // Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function() {
            searchBox.setBounds(map.getBounds());
        });

        // [START region_getplaces]
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener('places_changed', function() {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }


            var bounds = new google.maps.LatLngBounds();
            places.forEach(function(place) {

                myCurrentLocation.latitude = place.geometry.location.lat();
                myCurrentLocation.longitude = place.geometry.location.lng();

                myAddress=new google.maps.LatLng(place.geometry.location.lat(),place.geometry.location.lng());
                marker.setMap(null);
                marker=new google.maps.Marker({
                    position:myAddress,
                    draggable:true,
                    icon:new google.maps.MarkerImage('images/marker001.png',
                        new google.maps.Size(18, 50),
                        new google.maps.Point(0,0),
                        new google.maps.Point((18/2+0.4),50),
                        new google.maps.Size(18, 50)
                    )
                });
                marker.setMap(map);

                var contentString = ''+
                '<button onclick="window.parent.myCurrentLocation.setMyLocationByInfoWindow(this)">Set My Location </button>';

                var infowindow = new google.maps.InfoWindow({
                    content: contentString
                });
                marker.addListener('click', function() {
                    infowindow.open(map, marker);
                });

                google.maps.event.addListener(marker, 'dragend', function() 
                {
                    myCurrentLocation.latitude = marker.position.lat();
                    myCurrentLocation.longitude = marker.position.lng();
                });

                if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                } else {
                    bounds.extend(place.geometry.location);
                }
            });
            map.fitBounds(bounds);
        });
        //Initialize map not to display
        setTimeout(function(){ document.querySelector('#map').style.display = "none"; }, 20000);
        
        // [END region_getplaces]
        initAutocomplete2();
    }  
    function initAutocomplete2() {

        var marker;
        var map = new google.maps.Map(document.getElementById('map2'), {
            center: {
                lat: 13.0192151,
                lng: 77.55222650000002
            },
            zoom: 13,
            mapTypeControl:false,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        {
            //Initialize Latitude Longitude
            myCurrentLocation.latitude = 13.0192151;
            myCurrentLocation.longitude = 77.55222650000002;

            myAddress=new google.maps.LatLng(13.0192151,77.55222650000002);
            marker=new google.maps.Marker({
                position:myAddress,
                draggable:true,
                icon: new google.maps.MarkerImage('images/marker001.png',
                    new google.maps.Size(18, 50),
                    new google.maps.Point(0,0),
                    new google.maps.Point((18/2+0.4),50),
                    new google.maps.Size(18, 50)
                )
            });
            marker.setMap(map);

            var contentString = ''+
            '<button onclick="window.parent.myCurrentLocation.setMyLocationByInfoWindow(this)">Set My Location </button>';

            var infowindow = new google.maps.InfoWindow({
                content: contentString
            });
            marker.addListener('click', function() {
                infowindow.open(map, marker);
            });

            google.maps.event.addListener(marker, 'dragend', function() 
            {
                myCurrentLocation.latitude = marker.position.lat();
                myCurrentLocation.longitude = marker.position.lng();
            });
        }

        // Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input2');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function() {
            searchBox.setBounds(map.getBounds());
        });

        // [START region_getplaces]
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener('places_changed', function() {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }


            var bounds = new google.maps.LatLngBounds();
            places.forEach(function(place) {

                myCurrentLocation.latitude = place.geometry.location.lat();
                myCurrentLocation.longitude = place.geometry.location.lng();

                myAddress=new google.maps.LatLng(place.geometry.location.lat(),place.geometry.location.lng());
                marker.setMap(null);
                marker=new google.maps.Marker({
                    position:myAddress,
                    draggable:true,
                    icon:new google.maps.MarkerImage('images/marker001.png',
                        new google.maps.Size(18, 50),
                        new google.maps.Point(0,0),
                        new google.maps.Point((18/2+0.4),50),
                        new google.maps.Size(18, 50)
                    )
                });
                marker.setMap(map);

                var contentString = ''+
                '<button onclick="window.parent.myCurrentLocation.setMyLocationByInfoWindow(this)">Set My Location </button>';

                var infowindow = new google.maps.InfoWindow({
                    content: contentString
                });
                marker.addListener('click', function() {
                    infowindow.open(map, marker);
                });

                google.maps.event.addListener(marker, 'dragend', function() 
                {
                    myCurrentLocation.latitude = marker.position.lat();
                    myCurrentLocation.longitude = marker.position.lng();
                });

                if (place.geometry.viewport) {
                    // Only geocodes have viewport.
                    bounds.union(place.geometry.viewport);
                } else {
                    bounds.extend(place.geometry.location);
                }
            });
            map.fitBounds(bounds);
        });
        //Initialize map not to display
        setTimeout(function(){ document.querySelector('#map2').style.display = "none"; }, 20000);
        
        // [END region_getplaces]
    }
</script>
<!-- end -->

<!-- jquery for date picker -->
<!-- -->

    <script type="text/javascript">
        var errorData = [];
        window.onerror = function (a) {
            errorData.push(a);
        }
        function debugOutput (debuggingParam) {
            //
            debuggingParam = eval('(' + debuggingParam + ')');
            var debuggedStuff = "";
            for (var key in debuggingParam) {
                debuggedStuff += " "+key+"&nbsp;&nbsp;&nbsp;&nbsp; :"+" &nbsp;&nbsp;&nbsp;&nbsp;"+debuggingParam[key]+";<br><br>";
            }
            return debuggedStuff;
        }
        function debugOutputInText (debuggingParam) {
            debuggingParam.trim();
            debuggingParam = eval('(' + debuggingParam + ')');
            return debuggingParam;
        }
        function debuggger(debuggingValue){
            document.querySelector('#debugSpace').innerHTML = debugOutput(debuggingValue)+"";
        }
        function debugggerText(debuggingValue){
            document.querySelector('#debugSpace').innerHTML = debugOutputInText(debuggingValue)+"";
        }
        function letmedebug(factor) {
            switch(factor){
                case 0:
                    debuggger($('#myInput').val());
                    break;
                case 1:
                    debugggerText($('#myInput').val());
                    break;
                default:
                    break;
            }
        }
    </script>
    <script type="text/javascript">
        //Constants
        db = openDatabase('EAPMC', '1.0', 'Test DB', 100000000);
        vehicleIndex = 0;
        qualityAndPriceIndex = 0;
        mainurl = 'http://eapmc.com/mobile_app/farmer_executive';

        //Location functions
        var myCurrentLocation = {
            latitude : 0,
            longitude : 0
        };
        var myImage = {
            fileFolder : null
        };
        var testData  = {};
        var myImageUpload = {};
        var newTestData = {};
        
        //farmer Image upload
        myImageUpload.win = function (r) {
            alert('Image also has been successfully uploaded');
            myImageUpload.status = true;
        }

        myImageUpload.fail = function (error) {
            alert('Error uploading image please upload again');
            myImageUpload.status = false;
        }

        myImageUpload.upload = function(fileURL) {
            var options = new FileUploadOptions();
            options.fileKey = "file";
            options.fileName = fileURL.substr(fileURL.lastIndexOf('/') + 1);
            options.mimeType = "image/jpeg";

            var ft = new FileTransfer();
            newTestData.uploadOptions = options ;
            newTestData.fileTransfer = ft;
            ft.upload(fileURL, encodeURI(mainurl + "/signing/uploadphotos.php"), myImageUpload.win, myImageUpload.fail, options);
        }
        //

        myCurrentLocation.success = function(position) {
            myCurrentLocation.position = position;
            latitude_element = document.querySelectorAll('.mylatitude');
            longitude_element = document.querySelectorAll('.mylongitude');
            for(var i=0;i<latitude_element.length;i++){
                latitude_element[i].value = position.coords.latitude;
                longitude_element[i].value = position.coords.longitude;
            }
        }

        // onError Callback receives a PositionError object
        //
        myCurrentLocation.onError = function (error) {
            alert('code: '    + error.code    + '\n' + 'message: ' + error.message + '\n');
        }

        // Options: throw an error if no update is received every 30 seconds.
        //
        myCurrentLocation.getLocation = function () {
            navigator.geolocation.watchPosition(myCurrentLocation.success, myCurrentLocation.onError, myCurrentLocation.options);
        }

        myCurrentLocation.setLocationByMap = function() {
            myCurrentLocation.setLocationByMap.statusClicked = (myCurrentLocation.setLocationByMap.statusClicked !== undefined) ? !myCurrentLocation.setLocationByMap.statusClicked : true ;
            if(myCurrentLocation.setLocationByMap.statusClicked)
                document.querySelector('#map').style.display = "block";
            else
                document.querySelector('#map').style.display = "none";

            if(myCurrentLocation.latitude != 0 && myCurrentLocation.longitude != 0){
                document.querySelector('[name="farmer_latitude"]').value = myCurrentLocation.latitude;
                document.querySelector('[name="farmer_longitude"]').value = myCurrentLocation.longitude;
            }
        }

        myCurrentLocation.setLocationByMap2 = function() {
            myCurrentLocation.setLocationByMap2.statusClicked = (myCurrentLocation.setLocationByMap2.statusClicked !== undefined) ? !myCurrentLocation.setLocationByMap2.statusClicked : true ;
            if(myCurrentLocation.setLocationByMap2.statusClicked)
                document.querySelector('#map2').style.display = "block";
            else
                document.querySelector('#map2').style.display = "none";

            if(myCurrentLocation.latitude != 0 && myCurrentLocation.longitude != 0){
                document.querySelector('[name="transporter_latitude"]').value = myCurrentLocation.latitude;
                document.querySelector('[name="transporter_longitude"]').value = myCurrentLocation.longitude;
            }
        }

        myCurrentLocation.setMyLocationByInfoWindow = function(self) {
            event.preventDefault();
            myCurrentLocation.setLocationByMap();
        }

        myImage.onClickGetMyImage = function(obj) {
            this.textcamera = $(obj).data("textcamera");
            try{
                navigator.camera.getPicture(this.onSuccess, this.onFail, { 
                    quality: 50,
                    targetWidth: 200,
                    targetHeight: 200,
                    destinationType: Camera.DestinationType.FILE_URI 
                });
            }
            catch(error){
                newTestData.cameraerror = error;
            }
        }

        myImage.onSuccess = function(imageURI) {
            myImage.imageURI = imageURI;
            switch (myImage.textcamera) {
                case "farmerimage":
                    var image = document.getElementById('myImageElement');
                    image.src = imageURI;
                    myImage.fileName = imageURI.substring(imageURI.lastIndexOf('/')+1);
                    myImage.fileFolder = imageURI.substr(0,imageURI.lastIndexOf('/') + 1);
                    var farmer_image_name = document.getElementById('farmer_image_name');
                    farmer_image_name.value = myImage.fileName;
                    try{
                        setImageFileFolder(myImage.fileFolder);
                        // getImageFileFolder
                    }catch(error){
                        errorData.myImageSuccessError = error;
                    }
                    break;
                case "commodityimage":
                    var image = document.getElementById('commodityImageElement');
                    image.src = imageURI;
                    myImage.fileName = imageURI.substring(imageURI.lastIndexOf('/')+1);
                    var farmer_commodity_image_name = document.getElementById('farmer_commodity_image_name');
                    farmer_commodity_image_name.value = myImage.fileName;
                    myImage.fileFolder = imageURI.substr(0,imageURI.lastIndexOf('/') + 1);
                    try{
                        setImageFileFolder(myImage.fileFolder);
                        // getImageFileFolder
                    }catch(error){
                        errorData.myImageSuccessError = error;
                    }
                    break;
                case "transporterimage":
                    var image = document.getElementById('transporterImageElement');
                    image.src = imageURI;
                    myImage.fileName = imageURI.substring(imageURI.lastIndexOf('/')+1);
                    var tranporter_image_name = document.getElementById('tranporter_image_name');
                    tranporter_image_name.value = myImage.fileName;
                    break;
                default:
                    break;
            }
        }

        myImage.onFail = function(message) {
            myImage.failedMessage = message;
            alert('Failed because: ' + message);
        }

        //jquery functions started
        

        var login = function() {
            $.ajax( {
                url: mainurl + '/signing/signin.php',
                method: "POST",
                data: $("#farmer_executive_form").serialize(),
                async: true,
                success:function(data) {
                    $("#form_login_error").html(data.result).css("color","red");
                    info = "Login Success";
                    if(data.result.toLowerCase().indexOf(info.toLowerCase()) > -1){
                        $("#form_login_error").html(data.result).css("color","green");
                        getProductData();
                        setSessionData(data.session_id);
                        window.location.href = "#home_page";
                        document.getElementById("farmer_executive_form").reset();
                    }
                    else{
                        alert('Login failed');
                    }
                },
                error:function (xhr,status,error){
                    alert('Failed Connection');
                }
            });
        }
        var farmer_executive_signup_form = function() {
            $.ajax( {
                url: mainurl + '/signing/signup.php',
                method: "POST",
                data: $("#farmer_executive_signup_form").serialize(),
                async: true,
                success:function(data) {
                    $("#form_signup_error").html(data.result).css("color","red");
                    info = "You have successfully created Account.";
                    alert(data.result);
                    if(data.result.toLowerCase().indexOf(info.toLowerCase()) > -1){
                        $("#form_signup_error").html(data.result).css("color","green");
                        window.location.href = "#login_page";
                        document.getElementById("farmer_executive_signup_form").reset();
                    }
                    else{
                        alert('Creating Account Failed');
                    }
                },
                error:function (xhr,status,error){
                    alert('Failed Connection');
                }
            });
        }
        var farmersignup = function() {
            // myImageUpload.upload(myImage.imageURI);
            session_id = getSessionData();
            farmerRegistrationMobileNo = $("#farmer_registration_form").serializeArray()[1]['value'];

            $.ajax( {
                url: mainurl + '/signing/farmersignup.php',
                method: "POST",
                data: $("#farmer_registration_form").serialize() + "&session_id=" + session_id,
                success:function(data) {
                    alert(data.result);
                    $("#form_farmer_registration_error").html(data.result).css("color","red");
                    info = "You have been successfully registered";
                    if(data.result.toLowerCase().indexOf(info.toLowerCase()) > -1){
                        $("#form_farmer_registration_error").html(data.result).css("color","green");

                        db.transaction(function (tx) {
                            tx.executeSql('DELETE FROM EAPMC_FARMERS WHERE farmer_reg_mobile_number = "'+farmerRegistrationMobileNo+'"');
                        });
                        document.getElementById("farmer_registration_form").reset();
                    }
                    window.location.href = "#form_farmer_registration_error";
                    populateUnsignedFarmers();
                },
                error:function() {
                    alert('Error in Connection');
                    db.transaction(function (tx) {
                    
                        farmerRegistrationArray = $("#farmer_registration_form").serializeArray();
                        postArray = [];
                        for (var i = 0; i < farmerRegistrationArray.length; i++) {
                            postArray[farmerRegistrationArray[i].name] = farmerRegistrationArray[i].value;
                        }

                        //Validation
                        if(postArray['farmer_reg_name'] == ''){
                            alert('Farmer Name shouldn'+"'"+'t be empty');
                            return;
                        }

                        if(postArray['farmer_reg_mobile_number'] == ''){
                            alert('Farmer Mobile number shouldn'+"'"+'t be empty');
                            return;
                        }
                        if(postArray['farmer_image_name'] == ''){
                            alert('Please select the Image');
                            return;
                        }

                        if(postArray['farmer_reg_address'] == ''){
                            alert('Please fill the Address');
                            return;
                        }

                        if(isNaN(postArray['farmer_reg_district'])){
                            alert('Please select your district');
                            return;
                        }

                        postArrayString = ''+ Object.keys(postArray);
                        farmerDetailsString  = postArrayString.substring(0,postArrayString.lastIndexOf("farmer_reg_ifsc_code")+('farmer_reg_ifsc_code').length);

                        sqlStatement = 'CREATE TABLE IF NOT EXISTS EAPMC_FARMERS ('+farmerDetailsString+',farmer_crops_grown'+')';
                        tx.executeSql(sqlStatement);

                        if(postArray['farmer_reg_email'] != '')
                            farmerCountSql = 'SELECT COUNT(*) AS farmerCount FROM EAPMC_FARMERS WHERE farmer_reg_mobile_number = "'+postArray['farmer_reg_mobile_number']+'" OR farmer_reg_email = "'+ postArray['farmer_reg_email']+'"';
                        else
                            farmerCountSql = 'SELECT COUNT(*) AS farmerCount FROM EAPMC_FARMERS WHERE farmer_reg_mobile_number = "'+postArray['farmer_reg_mobile_number']+'"';

                        tx.executeSql(farmerCountSql, [], function (tx, results) {
                            if(results.rows.item(0).farmerCount == 0){
                                croppingMethodStart = false;
                                x = 0;
                                sqlStatementValues = '';
                                for(postElement in postArray){
                                    if(croppingMethodStart){
                                        if(x != (Object.keys(postArray).length-1))
                                            sqlStatementValues += postArray[postElement]+',';
                                        else
                                            sqlStatementValues += postArray[postElement]+'"';
                                    }else{
                                        if(x != (Object.keys(postArray).length-1))
                                            sqlStatementValues += '"'+postArray[postElement]+'",';
                                        else
                                            sqlStatementValues += '"'+postArray[postElement]+'"';
                                    }
                                    if(postElement == 'farmer_reg_ifsc_code'){
                                        if(x != (Object.keys(postArray).length-1))
                                            sqlStatementValues += '"';
                                        else{
                                            sqlStatementValues += ',""';
                                            break;
                                        }

                                        croppingMethodStart = true;
                                    }
                                    x++;
                                }
                                sqlStatement = 'INSERT INTO EAPMC_FARMERS ('+farmerDetailsString+',farmer_crops_grown'+') VALUES ('+sqlStatementValues+')';
                                tx.executeSql(sqlStatement);
                                alert('User created successfully locally');
                            }
                            else{
                                farmerExistSql = 'SELECT farmer_reg_mobile_number,farmer_reg_email FROM EAPMC_FARMERS  WHERE farmer_reg_mobile_number = "'+postArray['farmer_reg_mobile_number']+'"';

                                tx.executeSql(farmerExistSql, [], function (tx, results) {
                                    croppingMethodStart = false;
                                    x = 0;
                                    sqlStatementValues = '';
                                    for(postElement in postArray){
                                        if(croppingMethodStart){
                                            if(x != (Object.keys(postArray).length-1))
                                                sqlStatementValues += postArray[postElement]+',';
                                            else
                                                sqlStatementValues += postArray[postElement]+'"';
                                        }else{
                                            if(x != (Object.keys(postArray).length-1))
                                                sqlStatementValues += ' '+postElement+' = "'+postArray[postElement]+'",';
                                            else
                                                sqlStatementValues += ' '+postElement+' = "'+postArray[postElement]+'"';
                                        }
                                        if(postElement == 'farmer_reg_ifsc_code'){
                                            if(x != (Object.keys(postArray).length-1))
                                                sqlStatementValues += ' farmer_crops_grown = "';
                                            else{
                                                break;
                                            }
                                            croppingMethodStart = true;
                                        }
                                        x++;
                                    }

                                    farmerUpdateSql = 'UPDATE EAPMC_FARMERS SET '+sqlStatementValues+' WHERE farmer_reg_mobile_number = "'+results.rows.item(0).farmer_reg_mobile_number+'"';
                                    tx.executeSql(farmerUpdateSql);
                                }, null);
                            }
                        }, null);
                        document.getElementById("farmer_registration_form").reset();
                    });
                    populateUnsignedFarmers();
                }
            });
        }
        var addcommodity = function() {
            myImageUpload.upload(myImage.imageURI);
            $.ajax({
                url: mainurl + '/signing/addcommodity.php',
                method: "POST",
                data: $("#add_commodity_form").serialize(),
                success:function(data) {
                    alert(data.result);
                    $("#add_commodity_error").html(data.result).css("color","red");
                    info = "You have successfully added Commodity";
                    if(data.result.toLowerCase().indexOf(info.toLowerCase()) > -1){
                        $("#add_commodity_error").html(data.result).css("color","green");
                        document.getElementById("add_commodity_form").reset();
                        db.transaction(function (tx) {
                            tx.executeSql('DELETE FROM EAPMC_COMMODITIES WHERE rowid = "'+repopulateCommoditiesRegistration.commodityIndex+'"');
                        });
                    }
                    window.location.href = "#add_commodity_error";
                    populateCommodityList();
                },
                error:function(errorMessage) {
                    commodityFormArray = $("#add_commodity_form").serializeArray();
                    postArrayCommodity = [];
                    for (var i = 0; i < commodityFormArray.length; i++) {
                        postArrayCommodity[commodityFormArray[i].name] = commodityFormArray[i].value;
                    }

                    if(postArrayCommodity['farmer_mobile_number'] == ''){
                        alert('Mobile Number shouldn'+"'"+'t be empty');
                        return;
                    }

                    if(isNaN(postArrayCommodity['farmer_category'])){
                        alert('Please select the category');
                        return;
                    }

                    if(isNaN(postArrayCommodity['farmer_product'])){
                        alert('Please select the product');
                        return;
                    }
                    
                    if(isNaN(postArrayCommodity['farmver_variety'])){
                        // alert('Please select the variety');
                        // return;
                    }

                    if(postArrayCommodity['farmer_availability_from_date'] == ''){
                        alert('From date shouldn'+"'"+'t be empty');
                        return;
                    }

                    if(postArrayCommodity['farmer_availability_to_date'] == ''){
                        alert('To date shouldn'+"'"+'t be empty');
                        return;
                    }

                    if(postArrayCommodity['farmer_commodity_image_name'] == ''){
                        alert('Please choose an image of an product');
                        // return;
                    }
                    postArrayString = ''+ Object.keys(postArrayCommodity);

                    commodityDetailsString  = postArrayString.substring(0,postArrayString.lastIndexOf("farmer_commodity_image_name")+('farmer_commodity_image_name').length);

                    qualityAndPriceMethodStart = false;
                    x = 0,y=0;
                    sqlStatementValues = '';
                    for(postElement in postArrayCommodity){
                        if(qualityAndPriceMethodStart){
                            if(x != (Object.keys(postArrayCommodity).length-1)){
                                if(y%2 != 0)
                                    sqlStatementValues += postArrayCommodity[postElement]+',';
                                else
                                    sqlStatementValues += postArrayCommodity[postElement]+'#';
                                y++;
                            }
                            else
                                sqlStatementValues += postArrayCommodity[postElement]+'"';
                        }else{
                            if(x != (Object.keys(postArrayCommodity).length-1))
                                sqlStatementValues += '"'+postArrayCommodity[postElement]+'",';
                            else
                                sqlStatementValues += '"'+postArrayCommodity[postElement]+'"';
                        }
                        if(postElement == 'farmer_commodity_image_name'){
                            if(x != (Object.keys(postArrayCommodity).length-1))
                                sqlStatementValues += '"';
                            else{
                                sqlStatementValues += ',""';
                                break;
                            }

                            qualityAndPriceMethodStart = true;
                        }
                        x++;
                    }

                    sqlStatementCreateCommodities = 'CREATE TABLE IF NOT EXISTS EAPMC_COMMODITIES ('+commodityDetailsString+',qualityAndPrice'+')';
                    sqlStatementInsertCommodities = 'INSERT INTO EAPMC_COMMODITIES ('+commodityDetailsString+',qualityAndPrice'+') VALUES ('+sqlStatementValues+')';
                    db.transaction(function(tx) {
                        tx.executeSql(sqlStatementCreateCommodities);
                        tx.executeSql(sqlStatementInsertCommodities);  
                    });
                    alert('Commodity Added successfully locally');
                }
            });
            populateCommodityList();
        }
        var transportersignup = function() {
            myImageUpload.upload(myImage.imageURI);
            session_id = getSessionData();
            $.ajax( {
                url: mainurl + '/signing/transportersignup.php',
                method: "POST",
                data: $("#transporter_form").serialize() + "&session_id=" + session_id,
                success:function(data) {
                    console.log(data);
                    alert(data.result);
                    $("#transporter_error").html(data.result).css("color","red");
                    info = "You have been successfully registered";
                    if(data.result.toLowerCase().indexOf(info.toLowerCase()) > -1){
                        $("#transporter_error").html(data.result).css("color","green");
                        document.getElementById("transporter_form").reset();
                    }
                    window.location.href = "#transporter_error";
                },
                error:function (xhr,status,error){
                    alert('Failed Connection');
                }
            });
        }
        var logout = function() {
            $.ajax( {
                url: mainurl + '/signing/signout.php',
                method: "POST",
                data: [{"name" : "session_id","value":getSessionData()}],
                success:function(data) {
                    if(data.logoutStatus){
                        alert(data.result);
                        setSessionData("null");
                        window.location.href = '#login_page'
                    }
                }
            });
        }
        function onBodyLoad(){
            dosomething  = function(obj) {
                switch ($(obj).data("thisisme")) {
                    case "Login":
                        login();
                        break;
                    case "FarmerSignup":
                        farmersignup();
                        break;
                    case "AddCommodity":
                        addcommodity();
                        break;
                    case "TransporterSignup":
                        transportersignup();
                        break;
                    case "farmer_executive_signup_form":
                        farmer_executive_signup_form();
                        break;
                    case "logout":
                        logout();
                        break;
                    default:
                        break;
                } 
            }

            try{
                if (getSessionData() != "null" && getSessionData() != null) {
                    window.location.href = "#home_page"
                } else{
                    window.location.href = "#login_page"
                };
                $("#fromdates").click(function(){
                    var self = this;
                    var options = {
                        date: new Date(),
                        mode: 'date'
                    };

                    datePicker.show(options, function(unformattedDate){
                        date = unformattedDate.getDate();
                        month = unformattedDate.getMonth()+1;
                        year = unformattedDate.getFullYear();
                        formattedDate = year+"-"+month+"-"+date;
                        $(self).val(formattedDate);
                    });
                });
                $("#todates").click(function(){
                    var self = this;
                    var options = {
                        date: new Date(),
                        mode: 'date'
                    };

                    datePicker.show(options, function(unformattedDate){
                        date = unformattedDate.getDate();
                        month = unformattedDate.getMonth()+1;
                        year = unformattedDate.getFullYear();
                        formattedDate = year+"-"+month+"-"+date;
                        $(self).val(formattedDate);
                    });
                });
            }
            catch(error){
                testData.datepickererror = error;
            }
            try{
                $("#addMoreVehicles").click(function(){
                    vehicleIndex++;
                    var $template = $('#Vehicles'),
                        $clone    = $template
                                        .clone()
                                        .removeAttr('id')
                                        .attr('data-vehicle-index', vehicleIndex)
                                        .insertBefore($template);
                    
                    // Update the name attributes
                    $clone
                        .find('[name="vehicle[0][transportervehicletype]"]').attr('name', 'vehicle[' + vehicleIndex + '][transportervehicletype]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (vehicleIndex + 1);}).end()
                        .find('[name="vehicle[0][transportercostperkm]"]').attr('name', 'vehicle[' + vehicleIndex + '][transportercostperkm]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (vehicleIndex + 1);}).end()
                        .find('[name="vehicle[0][transporterminkm]"]').attr('name', 'vehicle[' + vehicleIndex + '][transporterminkm]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (vehicleIndex + 1);}).end()
                        .find('[name="vehicle[0][transportermincost]"]').attr('name', 'vehicle[' + vehicleIndex + '][transportermincost]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (vehicleIndex + 1);}).end()
                        .find('[name="vehicle[0][transportervehiclenumber]"]').attr('name', 'vehicle[' + vehicleIndex + '][transportervehiclenumber]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (vehicleIndex + 1);}).end();
                });

                $("#addQualityAndPrice").click(function(){
                    event.preventDefault();
                    qualityAndPriceIndex++;
                    var $template = $('#qualityAndPrice'),
                        $clone    = $template
                                        .clone()
                                        .removeAttr('id')
                                        .attr('data-cloned', true)
                                        .insertBefore($template);

                    $clone
                        .find('select')
                        .prev()
                        .html($($clone
                                .find('select')[0].options[0])
                            .html());

                    $clone
                        .find('input[type="text"]')
                        .val('');

                    // Update the name attributes
                    $clone
                        .find('[name="qualityAndPrice[0][farmer_quality]"]').attr('name', 'qualityAndPrice[' + qualityAndPriceIndex + '][farmer_quality]').attr('onclick','qualityChangeProcess(this)').attr('onchange','qualityChangeProcess(this)').end()
                        .find('[name="qualityAndPrice[0][farmer_ppk]"]').attr('name', 'qualityAndPrice[' + qualityAndPriceIndex + '][farmer_ppk]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (qualityAndPriceIndex + 1);}).end();
                });
            }
            catch(error){
                testData.addMoreVehiclesError = error;
            }
        }
        
        //* Get Field Values
        var getProductData = function() {
            $.getJSON(mainurl + "/information/getproductdata.php", function(data){
                testData.getProductData = data;
                setValuesToLocationStorage(data);
            });
        }
        var setSessionData = function(session_id) {
            if (typeof(Storage) !== "undefined") {
                if(session_id == null || session_id == 'null'){
                    localStorage.removeItem('session_id');
                }
                else{
                    localStorage.setItem("session_id", session_id);
                }
            } else {
                alert("Sorry, your browser does not support Web Storage...");
            }
        }
        var getSessionData = function() {
            if (typeof(Storage) !== "undefined") {
                session_id_from_local = localStorage.getItem("session_id");
                return session_id_from_local;
            } else {
                alert("Sorry, your browser does not support Web Storage...");
            }
        }
        var setImageFileFolder = function(fileFolder) {
            if (typeof(Storage) !== "undefined") {
                if(fileFolder == null){
                    localStorage.removeItem('fileFolder');
                }
                else{
                    localStorage.setItem("fileFolder", fileFolder);
                }
            } else {
                alert("Sorry, your browser does not support Web Storage...");
            }
        }
        var getImageFileFolder = function() {
            if (typeof(Storage) !== "undefined") {
                fileFolderFromLocal = localStorage.getItem("fileFolder");
                return fileFolderFromLocal;
            } else {
                alert("Sorry, your browser does not support Web Storage...");
            }
        }
        var getCategoryProducts = function(self) {
            db.transaction(function (tx) {
                tx.executeSql('SELECT id,productName,categoryID FROM EAPMC_PRODUCTS WHERE categoryID = '+self.value+'' , [], function (tx, results) {
                    $('#farmer_product_select').empty();
                    $('#farmer_product_select').append("<option>Select Product</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('#farmer_product_select').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).productName+"</option>");
                    }
                    if(getCategoryProducts.onSuccess !== undefined)
                        getCategoryProducts.onSuccess();
                }, null);
            });
        }
        var setValuesToLocationStorage = function(data) {
            db.transaction(function (tx) {

                //*Dropping existing tables
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_CATEGORIES');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_DISTRICTS');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_PRODUCTS');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_QUALITY');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_VARIETY');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_STATES');
                tx.executeSql('DROP TABLE IF EXISTS EAPMC_MODES_OF_TRANSPORT');

                tx.executeSql('CREATE TABLE EAPMC_CATEGORIES (id INTEGER, categoryName)');
                tx.executeSql('CREATE TABLE EAPMC_DISTRICTS (id INTEGER, districtName)');
                tx.executeSql('CREATE TABLE EAPMC_PRODUCTS (id INTEGER, productName, categoryID INTEGER)');
                tx.executeSql('CREATE TABLE EAPMC_QUALITY (id INTEGER, qualityName)');
                tx.executeSql('CREATE TABLE EAPMC_VARIETY (id INTEGER, variety_name)');
                tx.executeSql('CREATE TABLE EAPMC_STATES (id INTEGER, stateName)');
                tx.executeSql('CREATE TABLE EAPMC_MODES_OF_TRANSPORT (id INTEGER, modesOfTransport)');

                for (var i = 0; i < data.resultCategory.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_CATEGORIES (id, categoryName) VALUES ('+data.resultCategory[i].categoryID+', "'+data.resultCategory[i].categoryName+'")');
                }
                for (var i = 0; i < data.resultDistricts.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_DISTRICTS (id, districtName) VALUES ('+data.resultDistricts[i].districtID+', "'+data.resultDistricts[i].districtName+'")');
                }
                for (var i = 0; i < data.resultProducts.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_PRODUCTS (id, productName, categoryID) VALUES ('+data.resultProducts[i].productID+', "'+data.resultProducts[i].productName+'", '+data.resultProducts[i].categoryID+')');
                }
                for (var i = 0; i < data.resultQuality.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_QUALITY (id, qualityName) VALUES ('+data.resultQuality[i].qualityID+', "'+data.resultQuality[i].qualityName+'")');
                }
                for (var i = 0; i < data.resultVariety.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_VARIETY (id, variety_name) VALUES ('+data.resultVariety[i].variety_id+', "'+data.resultVariety[i].variety_name+'")');
                }
                for (var i = 0; i < data.resultStates.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_STATES (id, stateName) VALUES ('+data.resultStates[i].stateID+', "'+data.resultStates[i].stateName+'")');
                }
                for (var i = 0; i < data.resultModesofTransport.length; i++) {
                    tx.executeSql('INSERT INTO EAPMC_MODES_OF_TRANSPORT (id, modesOfTransport) VALUES ('+data.resultModesofTransport[i].mtrid+', "'+data.resultModesofTransport[i].type+'")');
                }
            });
            setLocalStorage();
            populateCropsCheckboxes();
        }
        var setLocalStorage = function() {
            db.transaction(function (tx) {
                tx.executeSql('SELECT id,districtName FROM EAPMC_DISTRICTS', [], function (tx, results) {
                    testData.districts = results;
                    $('.districts').empty();
                    $('.districts').append("<option>Select District</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('.districts').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).districtName+"</option>");
                    }
                }, null);
                tx.executeSql('SELECT id,stateName FROM EAPMC_STATES', [], function (tx, results) {
                    testData.states = results;
                    $('.states').empty();
                    $('.states').append("<option>Select State</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('.states').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).stateName+"</option>");
                    }
                }, null);
                tx.executeSql('SELECT id,categoryName FROM EAPMC_CATEGORIES', [], function (tx, results) {
                    $('#farmer_category').empty();
                    $('#farmer_category').append("<option>Select Category</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('#farmer_category').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).categoryName+"</option>");
                    }
                }, null);
                /*tx.executeSql('SELECT id,productName,categoryID FROM EAPMC_PRODUCTS', [], function (tx, results) {
                    $('#farmer_product_select').empty();
                    $('#farmer_product_select').append("<option>Select Product</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('#farmer_product_select').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).productName+"</option>");
                    }
                }, null);*/
                tx.executeSql('SELECT id,variety_name FROM EAPMC_VARIETY', [], function (tx, results) {
                    $('#farmver_variety').empty();
                    $('#farmver_variety').append("<option>Select Variety</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('#farmver_variety').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).variety_name+"</option>");
                    }
                }, null);
                tx.executeSql('SELECT id,qualityName FROM EAPMC_QUALITY', [], function (tx, results) {
                    $('#farmer_quality').empty();
                    $('#farmer_quality').append("<option>Select Quality</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('#farmer_quality').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).qualityName+"</option>");
                    }
                }, null);
                tx.executeSql('SELECT id,modesOfTransport FROM EAPMC_MODES_OF_TRANSPORT', [], function (tx, results) {
                    $('.modesoftransport').empty();
                    $('.modesoftransport').append("<option>Select Vehicle</option>");
                    for (var i = 0; i < results.rows.length; i++) {
                        $('.modesoftransport').append("<option value="+results.rows.item(i).id+">"+results.rows.item(i).modesOfTransport+"</option>");
                    }
                }, null);
            });
        }
        $(document).ready(function(){
            setLocalStorage();
            populateUnsignedFarmers();
            populateCommodityList();
            $('#farmersignedwithoutconnection').listify();
            populateCropsCheckboxes();
        });
        var populateCropsCheckboxes = function() {
                db.transaction(function (tx) {
                    tx.executeSql('SELECT id,productName,categoryID FROM EAPMC_PRODUCTS', [], function (tx, results) {
                        categoriesAddingHTML = '';
                        for (var i = 0; i < results.rows.length; i++) {
                            categoriesAddingHTML += '<label><input type="checkbox" name="farmer_crops_grown['+i+']" value="'+results.rows.item(i).id+'"/>'+results.rows.item(i).productName+'</label>';
                        }
                        $(categoriesAddingHTML).insertAfter("#categoriesAdding");
                    }, null);
                });
        }
        var populateUnsignedFarmers = function() {
            db.transaction(function (tx) {
                tx.executeSql('SELECT farmer_reg_mobile_number,farmer_reg_name FROM EAPMC_FARMERS', [], function (tx, results) {
                    errorData.farmerRegistrationArray = results.rows;
                    try{
                        $('#farmersignedwithoutconnection').listify({
                            listifyArrayObject : results.rows,
                            fromWebSql : true
                        });
                    }catch(error){
                        errorData.listifyError = error;
                    }
                }, null);
            });
        }
        var populateCommodityList = function() {
            db.transaction(function (tx) {
                tx.executeSql('SELECT rowid,farmer_mobile_number FROM EAPMC_COMMODITIES', [], function (tx, results) {
                    commoditiesNumberArray = [];
                    for (var i = results.rows.length - 1,j=0; i >= 0; i--,j++) {
                        commoditiesNumberArray[i] = {};
                        commoditiesNumberArray[i].commodityIndex = j+1;
                        commoditiesNumberArray[i].mobileNumber = results.rows.item(i).farmer_mobile_number;
                    }

                    $('#commoditywithoutconnection').listify({
                        listifyArrayObject : commoditiesNumberArray
                    });
                }, null);
            });
        }
        var repopulateFarmerRegistration = function(self) {
            document.getElementById("farmer_registration_form").reset();
            var mobileNumber = $(self).find('[data-key="farmer_reg_mobile_number"]').html();
            db.transaction(function (tx) {
                tx.executeSql('SELECT * FROM EAPMC_FARMERS WHERE farmer_reg_mobile_number = "'+mobileNumber+'"', [], function (tx, results) {
                    if(results.rows.length){
                        window.location.href = '#farmer_registration';
                        postArray = results.rows.item(0);
                        farmerRegistrationFormElement = $('#farmer_registration_form');
                        for(postElement in postArray){
                            elem = farmerRegistrationFormElement.find('[name*="'+postElement+'"]');
                            if(elem.prop('tagName') == 'INPUT'){
                                if(elem.attr('type') == 'hidden' || elem.attr('type') == 'text'){
                                    elem.val('');
                                    elem.val(postArray[postElement]);
                                }
                                if(elem.attr('type') == 'checkbox'){
                                    checkboxArray = postArray[postElement].split(",");
                                    elem.each(function() {
                                        for (var i = 0; i < checkboxArray.length; i++) {
                                            if(checkboxArray[i] == this.value){
                                                $(this).attr('checked','true');
                                            }
                                        };
                                    });
                                }
                            }
                            else if(elem.prop('tagName') == 'SELECT'){
                                elem.find('option').each(function() {
                                    if(parseInt(postArray[postElement]) == parseInt(this.value)){
                                        this.defaultSelected = true;
                                        $(this).attr('selected','selected');
                                        elem.prev().html($(this).text());
                                    }
                                    else{
                                        $(this).removeAttr('selected');
                                    }
                                });
                            }
                            else if(elem.prop('tagName') == 'TEXTAREA'){
                                elem.val('');
                                elem.val(postArray[postElement]);
                            }
                        }
                        try{
                            var image = document.getElementById('myImageElement');
                            if(getImageFileFolder() != null){
                                image.src = getImageFileFolder() + postArray['farmer_image_name'];
                                myImage.imageURI = getImageFileFolder() + postArray['farmer_image_name'];
                            }
                            else
                                image.src = "res/screen/android/screen-hdpi-portrait.png";
                        }
                        catch(error){
                            errorData.settingUriError = error;
                        }
                    }
                }, null);
            });
        }
        var repopulateCommoditiesRegistration = function(self) {
            document.getElementById("add_commodity_form").reset();
            $('[data-cloned]').remove();
            var commodityIndex = $(self).find('[data-key="commodityIndex"]').html();
            repopulateCommoditiesRegistration.commodityIndex = commodityIndex;
            db.transaction(function (tx) {
                tx.executeSql('SELECT * FROM EAPMC_COMMODITIES', [], function (tx, results) {
                    if(results.rows.length){
                        window.location.href = '#farmer_product';
                        postArray = results.rows.item(parseInt(commodityIndex)-1);
                        commodityRegistrationFormElement = $('#add_commodity_form');
                        for(postElement in postArray){
                            elem = commodityRegistrationFormElement.find('[name*="'+postElement+'"]');
                            if(postElement == 'qualityAndPrice'){
                                qualityAndPriceArray = postArray[postElement].split(",");
                                cloneUntil = qualityAndPriceArray.length - 1;
                                while(cloneUntil--){
                                    qualityAndPriceIndex++;
                                    var $template = $('#qualityAndPrice'),
                                        $clone    = $template
                                                        .clone()
                                                        .removeAttr('id')
                                                        .attr('data-cloned', true)
                                                        .insertBefore($template);

                                    $clone
                                        .find('select')
                                        .prev()
                                        .html($($clone
                                                .find('select')[0].options[0])
                                            .html());

                                    $clone
                                        .find('input[type="text"]')
                                        .val('');

                                    // Update the name attributes
                                    $clone
                                        .find('[name="qualityAndPrice[0][farmer_quality]"]').attr('name', 'qualityAndPrice[' + qualityAndPriceIndex + '][farmer_quality]').attr('onclick','qualityChangeProcess(this)').end()
                                        .find('[name="qualityAndPrice[0][farmer_ppk]"]').attr('name', 'qualityAndPrice[' + qualityAndPriceIndex + '][farmer_ppk]').attr('placeholder',function() { return $(this).attr('placeholder') + " " + (qualityAndPriceIndex + 1);}).end();
                                }
                                qpArray = [];
                                qpIndex = 0;
                                for (var i = 0; i < qualityAndPriceArray.length; i++) {
                                    qpArray[qpIndex++] = qualityAndPriceArray[i].substring(0,qualityAndPriceArray[i].lastIndexOf('#'));
                                    qpArray[qpIndex++] = qualityAndPriceArray[i].substring(qualityAndPriceArray[i].lastIndexOf('#')+1);
                                };
                                qualityAndPriceElement = commodityRegistrationFormElement.find('[name*="'+postElement+'"]');
                                qualityAndPriceElementIndex = 0;
                                qualityAndPriceElement.each(function() {
                                    if(qualityAndPriceElementIndex % 2 == 0){
                                        $(this)
                                        .prev()
                                        .html($(this)
                                            .find('option[value="'+qpArray[qualityAndPriceElementIndex]+'"]')
                                            .text())
                                        .find('option[value="'+qpArray[qualityAndPriceElementIndex]+'"]')
                                        .attr('selected','selected');
                                    }
                                    else{
                                        $(this).val(qpArray[qualityAndPriceElementIndex]);
                                    }
                                    qualityAndPriceElementIndex++;
                                });
                            }

                            if(elem.prop('tagName') == 'INPUT'){
                                if(elem.attr('type') == 'hidden' || elem.attr('type') == 'text'){
                                    elem.val('');
                                    elem.val(postArray[postElement]);
                                }
                            }
                            else if(elem.prop('tagName') == 'SELECT'){
                                if(postElement == 'farmer_category'){
                                    getCategoryProducts({
                                        value : postArray[postElement]
                                    });
                                }
                                if(postElement == 'farmer_product'){
                                    farmerProductElement = elem;
                                    selectedValue = postArray[postElement];
                                    getCategoryProducts.onSuccess = function() {
                                        farmerProductElement.find('option').each(function() {
                                            if(parseInt(selectedValue) == parseInt(this.value)){
                                                this.defaultSelected = true;
                                                $(this).attr('selected','selected');
                                                farmerProductElement.prev().html($(this).text());
                                            }
                                            else{
                                                $(this).removeAttr('selected');
                                            }
                                        });
                                    }  
                                }
                                elem.find('option').each(function() {
                                    if(parseInt(postArray[postElement]) == parseInt(this.value)){
                                        this.defaultSelected = true;
                                        $(this).attr('selected','selected');
                                        elem.prev().html($(this).text());
                                    }
                                    else{
                                        $(this).removeAttr('selected');
                                    }
                                });
                            }
                            else if(elem.prop('tagName') == 'TEXTAREA'){
                                elem.val('');
                                elem.val(postArray[postElement]);
                            }
                        }

                        try{
                            var image = document.getElementById('commodityImageElement');
                            if(getImageFileFolder() != null){
                                image.src = getImageFileFolder() + postArray['farmer_commodity_image_name'];
                                myImage.imageURI = getImageFileFolder() + postArray['farmer_commodity_image_name'];
                            }
                            else
                                image.src = "res/screen/android/screen-hdpi-portrait.png";
                        }
                        catch(error){
                            errorData.settingUriError = error;
                        }
                    }
                }, null);
            });
        }
        var qualityChangeProcess = function(self) {
            $(self).prev().html($(self.options[self.selectedIndex]).text());
        }
        var FarmendSupplyClick = function(self) {
            farmerSupply = document.getElementById('farmer_farmend_supply');
            farmerSupply.value = self.checked;
        }
    </script>
</head>

<body onLoad="onBodyLoad()" style="background-color:#FFF;">
    <!-- login page starts here -->
    <div data-role="page" id="login_page" style="background-color:#FFF;">
        <!-- login header starts -->
        <div data-role="header" align="center" style="padding-top:10px; background-color:#FFF; border:0px;">
            <img src="images/logo.png" /><br />
            <span>Farmer Empowerment App</span>
        </div>
        <!-- Login header ends -->
        
        <!-- body container starts -->
        <div id="form_login_error"></div>
        <div data-role="content" style="background:#FFF;">
            <form class="login_form" id="farmer_executive_form" method="post">
                <label>
                    <input type="text" name="username" placeholder="User Name" />
                </label>
                <label>
                    <input type="password" name="password" placeholder="Password" />
                </label>
                <label>
                    <input type="button" value="Login" onClick="dosomething(this)" data-thisisme="Login"/>
                </label>
                <a href="#createExecutiveAccount">Create Account</a>
            </form>
        </div>
        <!-- body container ends -->
        <!-- footer starts for login -->
        <div data-role="footer" style="border:0px; background-color:#FFF;">
        
        </div>
        <!-- footer ends for Login -->
    </div>
    <!-- end of login page -->
    <div data-role="page" id="createExecutiveAccount" style="background-color:#FFF;">
        <!-- login header starts -->
        <div data-role="header"  align="center" style="padding-top:10px; background-color:#FFF; border:0px;">
            <img src="images/logo.png" style="padding-top:10px;" /><br />
            <span>Farmer Empowerment App</span>
        </div>
        <!-- Login header ends -->
        
        <!-- body container starts -->
        <div id="form_signup_error"></div>
        <div data-role="content" style="background-color:#FFF;">
            <form class="login_form" id="farmer_executive_signup_form" method="post">
                <label>
                    <input type="text" name="username" placeholder="User Name" />
                </label>
                <label>
                    <input type="password" name="password" placeholder="Password" />
                </label>
                <label>
                    <input type="password" name="confirm_password" placeholder="Confirm Password" />
                </label>
                <label>
                    <input type="text" name="emailid" placeholder="Email ID" />
                </label>
                <label>
                    <input type="text" name="phonenumber" placeholder="Phone Number or Mobile Number" />
                </label>
                <label>
                    <input type="button" value="Create your Account" onClick="dosomething(this)" data-thisisme="farmer_executive_signup_form"/>
                </label>
            </form>
        </div>
        <!-- body container ends -->
        <!-- footer starts for login -->
        <div data-role="footer" style="background-color:#FFF; border:0px;">
        
        </div>
        <!-- footer ends for Login -->
    </div>
    <!-- start of home page -->
    <div data-role="page" id="home_page" style="background-color:#FFF;">
        <!-- no header -->
        <div data-role="header" align="center" style="border:0px;">
        
        </div>
        <!-- no header -->
        
        <!-- home content area -->
        <div data-role="content">
            <div style="float:left;">
                <div class="home_nav">
                    <!-- <textarea id="myInput" rows="50" cols="50"></textarea>
                    <button onclick="letmedebug(0)">Debug Me</button>
                    <button onclick="letmedebug(1)">Debug Me Into Text</button>
                    <div id="debugSpace" style="background:black;color:white"></div> -->
                    <ul style="margin:0px; padding:0px; list-style:none;">
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#farmer_registration"><img src="images/farmer_reg.png" /><br />Register Farmer</a></li>
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#farmer_product"><img src="images/add_stock.png" /><br />Add Stock</a></li>
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#transporter"><img src="images/add_transporter.png" /><br />Transporter</a></li>
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#listoffarmendwithoutconnection"><img src="images/add_transporter.png" /><br />List of Unsigned Farmers</a></li>
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#listofcommoditieswithoutconnection"><img src="images/add_transporter.png" /><br />List of Added commodities</a></li>
                    </ul>   
                    <ul style="margin:0px; padding:0px; list-style:none;">
                        <li style="padding:.5em; border:1px solid #CCC; margin-bottom:1em;"><a href="#" onclick="dosomething(this)" data-thisisme="logout"><img src="images/add_transporter.png" /><br />Logout</a></li>
                    </ul>
                </div>
            </div>
            <div style="float:right;">
                <img src="images/logo.png" />
            </div>
        </div>
        <!-- home content area ends -->
    </div>
    <!-- end of the home page -->
    
    <!-- registration page starts -->
    <div data-role="page" id="farmer_registration" style="background-color:#FFF;">
        <!-- header section for registration -->
        <div data-role="header" align="center" style="padding-top:10px; background-color:#FFF; border:0px;">
            <img src="images/logo.png" /><br />Farmer Empowerment App
        </div>
        <!-- header section for registration ends -->
        
        
        <!-- Navigation Starts -->
        <div style="z-index:10; position:absolute; top:2em; left:2em;">
            <a href="#home_page"><img src="images/nav.png" /></a>
        </div>
        <!-- Navigation ends -->
        
        <!-- registration body starts -->
        <div data-role="content" style="background-color:#FFF;">
            <div id="form_farmer_registration_error"></div>
            <form class="login_form" id="farmer_registration_form">
                <label>
                    <input type="text" name="farmer_reg_name" placeholder="Farmer Name" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_mobile_number" placeholder="Mobile Number" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_email" placeholder="Email Id" />
                </label>
                <label>
                    <textarea name="farmer_reg_address" rows="4" cols="84" placeholder="Enter Address Here..."></textarea>
                </label>
                <label>
                    <select name="farmer_reg_district" class="districts">
                        <option value="0">Select District</option>
                    </select>
                </label>
                <label>
                    <input type="hidden" name="farmer_image_name" id="farmer_image_name">
                    <input type="hidden" name="farmer_farmend_supply" id="farmer_farmend_supply">
                    <img src="res/screen/android/screen-hdpi-portrait.png" height="100" width="200" id="myImageElement">
                    <input type="button" onClick="myImage.onClickGetMyImage(this)" data-textcamera='farmerimage' value="Take Photo" />
                </label>
                <label>
                    <input type="text" class="mylatitude" name="farmer_latitude" placeholder="Latitude" />
                    <input type="text" class="mylongitude" name="farmer_longitude" placeholder="Longitude" />
                    <input type="button" value="Google Location" onClick="myCurrentLocation.getLocation()" />
                    <input type="button" value="Add Different Location"  onclick="myCurrentLocation.setLocationByMap(this)" />
                    <div style="display:block;">
                        <input id="pac-input" class="controls" type="text" placeholder="Search Box">
                        <div id="map" style="width:100%;height:300px"></div>
                    </div>
                </label>
                <span class="login_header">Bank Account Details</span>
                <label>
                    <input type="text" name="farmer_reg_account_number" placeholder="Account Number" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_account_holder_name" placeholder="Account Holder Name" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_bank_name" placeholder="Bank Name" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_bank_branch" placeholder="Branch" />
                </label>
                <label>
                    <input type="text" name="farmer_reg_ifsc_code" placeholder="IFSC Code" />
                </label>
                <label>
                    <input type="checkbox" onchange="FarmendSupplyClick(this)" />Farmer to supply for Farmend also
                </label>
                <h2 style="font-size:1.4em; color:#0685c3; font-weight:normal;" id="categoriesAdding">Crops Grown by farmer</h2>
                <!-- <h3 style="font-size:1.2em; color:#0685c3; font-weight:normal;">Vegetables</h3>
                    <label><input type="checkbox" name="Carrot" />Carrot</label>
                    <label><input type="checkbox" name="Beetroot" />Beetroot</label>
                    <label><input type="checkbox" name="Beans" />Beans</label>
                <h3 style="font-size:1.2em; color:#0685c3; font-weight:normal;">Fruits</h3>
                    <label><input type="checkbox" name="Orange" />Orange</label>
                    <label><input type="checkbox" name="Grapes" />Grapes</label>
                    <label><input type="checkbox" name="Banana" />Banana</label> -->
                
                <label>
                    <input type="button" value="Create Account" onClick="dosomething(this)" data-thisisme="FarmerSignup"/>
                </label>
            </form>
            
            
            
        </div>
        <!-- registration body ends -->
        
        <!-- footer Starts -->
        <div data-role="footer" style="background-color:#FFF;">
        
        </div>
        <!-- Footer Ends -->
    </div>
    <!-- registration page ends -->
    
    <!-- Add Commodity page starts -->
    <div data-role="page" id="farmer_product" style="background-color:#FFF;">
        <!-- header section for Commodity -->
        <div data-role="header" align="center" style="padding-top:10px; background-color:#FFF; border:0px;">
            <img src="images/logo.png" /><br />Farmer Empowerment App
        </div>
        <!-- header section for registration ends -->
        
        
        <!-- Navigation Starts -->
        <div style="z-index:10; position:absolute; top:2em; left:2em;">
            <a href="#home_page"><img src="images/nav.png" /></a>
        </div>
        <!-- Navigation ends -->
        
        <!-- Add Commodity body starts -->
        <div data-role="content">
            <div id="add_commodity_error"></div>
            <form class="login_form" id="add_commodity_form">
                <span>
                Add Commodity
                </span>
                <label>
                    <input type="text" name="farmer_mobile_number" placeholder="Farmer Mobile Number" />
                </label>
                <label>
                    <select name="farmer_category" id="farmer_category" onchange="getCategoryProducts(this)">
                        <option value="0">Select Category</option>
                    </select>
                </label>
                <label>
                    <select name="farmer_product" id="farmer_product_select">
                        <option value="0">Select Product</option>
                    </select>
                </label>
                <label>
                    <select name="farmver_variety" id="farmver_variety">
                        <option value="0">Select Variety</option>
                    </select>
                </label>
                <label>
                    From
                    <input type="text" name="farmer_availability_from_date" placeholder="YYYY-MM-DD" id="fromdates" />
                </label>
                <label>
                    To
                    <input type="text" name="farmer_availability_to_date" placeholder="YYYY-MM-DD" id="todates" />
                </label>
                <label>
                    <input type="text" name="farmer_quantity" placeholder="Quantity" />
                </label>                
                <label>
                    <input type="hidden" name="farmer_commodity_image_name" id="farmer_commodity_image_name">
                    <img src="res/screen/android/screen-hdpi-portrait.png" height="100" width="200" id="commodityImageElement">
                    <input type="button" value="Product Photo"  onclick="myImage.onClickGetMyImage(this)" data-textcamera='commodityimage' />
                </label>
                <div id="qualityAndPrice">
                    <label>
                        Quality and Price
                    </label>
                    <label>
                        <select name="qualityAndPrice[0][farmer_quality]" id="farmer_quality">
                            <option value="0">Select Quality</option>
                        </select>
                    </label>
                    <label>
                        <input type="text" name="qualityAndPrice[0][farmer_ppk]" placeholder="Price Per Kilo" />
                    </label>
                </div>
                <label>
                    <button id="addQualityAndPrice">Add More</button>
                </label>
                <label>
                    <input type="button" value="Add Product" placeholder="Add Product" onClick="dosomething(this)" data-thisisme="AddCommodity"/>
                </label>
            </form>
            
        </div>
        <!-- Add Commodity body ends -->
        
        <!-- footer Starts -->
        <div data-role="footer" style="background-color:#FFF;">
        
        </div>
        <!-- Footer Ends -->
    </div>
    <!-- Add Commodity page ends -->

    <div data-role="page" id="transporter" style="background-color:#FFF;">
        <!-- header section for Commodity -->
        <div data-role="header" align="center" style="padding-top:10px; background-color:#FFF; border:0px;">
            <img src="images/logo.png" /><br />Transporter
        </div>
        <!-- header section for registration ends -->
        
        
        <!-- Navigation Starts -->
        <div style="z-index:10; position:absolute; top:2em; left:2em;">
            <a href="#home_page"><img src="images/nav.png" /></a>
        </div>
        <!-- Navigation ends -->
        
        <!-- Add Commodity body starts -->
        <div data-role="content" class="login_content">
            <div id="transporter_error"></div>
            <form class="login_form" id="transporter_form">
                <span>
                Transporter
                </span>
                <label>
                    <input name="transporterName" type="text" placeholder="Transporter Name">
                </label>
                <label>
                    <textarea name="transporterAddress" placeholder="Transporter Address" rows="50"></textarea>
                </label>
                <label>
                    <select name="transporterState" id="transporterState" class="states">
                        <option value="0">Select State</option>
                    </select>
                </label>
                <label>
                    <select name="transporterCity" id="transporterCity" class="districts">
                        <option value="0">Select City</option>
                    </select>
                </label>
                <label>
                    <input name="transporterpincode" type="text" placeholder="Pincode">
                </label>               
                <label>
                    <input type="hidden" name="tranporter_image_name" id="tranporter_image_name">
                    <img src="res/screen/android/screen-hdpi-portrait.png" height="100" width="200" id="transporterImageElement">
                    <input type="button" value="Transporter Photo"  onclick="myImage.onClickGetMyImage(this)" data-textcamera='transporterimage' />
                </label>  
                <label>
                    <input name="transportermobile" type="text" placeholder="Mobile Number">
                </label>
                <label>
                    <input type="text" class="mylatitude" name="transporter_latitude" placeholder="Latitude" />
                    <input type="text" class="mylongitude" name="transporter_longitude" placeholder="Longitude" />
                    <input type="button" value="Get My Location" onClick="myCurrentLocation.getLocation()" />
                    <!-- <input type="button" value="Add Different Location"  onclick="myCurrentLocation.setLocationByMap2(this)" />
                    <div style="display:block;">
                        <input id="pac-input2" class="controls" type="text" placeholder="Search Box">
                        <div id="map2" style="width:100%;height:300px"></div>
                    </div> -->
                </label>
                <div id="Vehicles">
                    <span class="login_header">
                    Vehicle Details
                    </span>
                    <label>
                        <!-- <input name="vehicle[0][transportervehicletype]" type="text" placeholder="Vehicle Type"> -->
                        <select name="vehicle[0][transportervehicletype]" class="modesoftransport">
                            <option value="0">Select Vehicle</option>
                        </select>
                    </label>
                    <label>
                        <input name="vehicle[0][transportercostperkm]" type="text" placeholder="Cost Per Kilometer">
                    </label>
                    <label>
                        <input name="vehicle[0][transporterminkm]" type="text" placeholder="Minimum kilometer">
                    </label>
                    <label>
                        <input name="vehicle[0][transportermincost]" type="text" placeholder="Minimum Cost">
                    </label>
                    <label>
                        <input name="vehicle[0][transportervehiclenumber]" type="text" placeholder="Vehicle Number">
                    </label>
                </div>               
                <!-- <label>
                    <input type="button" value="Add More" id="addMoreVehicles" />
                </label> -->
                <label>
                    <input type="button" value="Save" onClick="dosomething(this)" data-thisisme="TransporterSignup"/>
                </label>
            </form>
            
        </div>
        <!-- Add Commodity body ends -->
        
        <!-- footer Starts -->
        <div data-role="footer" style="background-color:#FFF;">
        
        </div>
        <!-- Footer Ends -->
    </div>


    <div data-role="page" id="listoffarmendwithoutconnection">
        <div data-role="main" class="ui-content">
            <h2>List of Unsigned Farmers :</h2>
            <ul data-role="listview" data-inset="true">
                <li id="farmersignedwithoutconnection" onclick="repopulateFarmerRegistration(this)">
                    <a href="#">
                        <span data-value-exist="true" data-key="farmer_reg_name"></span>
                        (
                            <strong data-value-exist="true" data-key="farmer_reg_mobile_number"></strong>
                        )
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div data-role="page" id="listofcommoditieswithoutconnection">
        <div data-role="main" class="ui-content">
            <h2>List of Added Commodities :</h2>
            <ul data-role="listview" data-inset="true">
                <li id="commoditywithoutconnection" onclick="repopulateCommoditiesRegistration(this)">
                    (<span data-value-exist="true" data-key="commodityIndex"></span>)
                    <span data-value-exist="true" data-key="mobileNumber"></span>
                </li>
            </ul>
        </div>
    </div>
</body>
</html>